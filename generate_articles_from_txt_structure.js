#!/usr/bin/env node

/**
 * txtãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°æ§‹æˆæ¡ˆé€šã‚Šã«è¨˜äº‹ã‚’ç”Ÿæˆï¼ˆå®Œå…¨å¯¾å¿œç‰ˆï¼‰
 */

const fs = require('fs').promises;
const path = require('path');

async function generateArticlesFromTxtStructure() {
  try {
    console.log('ğŸš€ txtãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆæ¡ˆã«åŸºã¥ãè¨˜äº‹ç”Ÿæˆé–‹å§‹...');
    
    // txtãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè©³ç´°æ§‹æˆæ¡ˆï¼‰ã‚’èª­ã¿è¾¼ã¿
    const txtFilePath = path.join(__dirname, '../Desktop/ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æçµæœã€‘.txt');
    const txtContent = await fs.readFile(txtFilePath, 'utf8');
    
    // 3ã¤ã®è¨˜äº‹æ§‹æˆã‚’æŠ½å‡º
    const articleStructures = extractArticleStructures(txtContent);
    
    const results = [];
    
    for (let i = 0; i < articleStructures.length; i++) {
      const structure = articleStructures[i];
      
      console.log(`\nğŸ“ è¨˜äº‹${i + 1}ç”Ÿæˆé–‹å§‹: ${structure.keyword}`);
      
      // txtæ§‹æˆæ¡ˆã«å®Œå…¨æº–æ‹ ã—ã¦è¨˜äº‹ç”Ÿæˆ
      const article = await generateArticleFromStructure(structure);
      
      // ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
      const outputPath = path.join(__dirname, `outputs/txt_based_article${i + 1}_${generateSlug(structure.keyword)}.json`);
      await fs.writeFile(outputPath, JSON.stringify(article, null, 2), 'utf8');
      
      console.log(`âœ… è¨˜äº‹${i + 1}ç”Ÿæˆå®Œäº†!`);
      console.log(`ğŸ“„ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ${structure.keyword}`);
      console.log(`ğŸ“Š äºˆå®šæ–‡å­—æ•°: ${structure.targetWordCount}æ–‡å­—`);
      console.log(`ğŸ¯ æ§‹æˆã‚»ã‚¯ã‚·ãƒ§ãƒ³æ•°: ${structure.sections.length}å€‹`);
      
      results.push(article);
    }
    
    console.log('\nğŸ‰ txtæ§‹æˆæ¡ˆãƒ™ãƒ¼ã‚¹è¨˜äº‹ç”Ÿæˆå®Œäº†ï¼');
    return results;
    
  } catch (error) {
    console.error('âŒ è¨˜äº‹ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error.message);
    throw error;
  }
}

function extractArticleStructures(txtContent) {
  const structures = [];
  
  // è¨˜äº‹æ§‹æˆ1ã‚’æŠ½å‡º
  const structure1 = extractInvoiceStructure(txtContent);
  structures.push(structure1);
  
  // è¨˜äº‹æ§‹æˆ2ã‚’æŠ½å‡º
  const structure2 = extractItSubsidyStructure(txtContent);
  structures.push(structure2);
  
  // è¨˜äº‹æ§‹æˆ3ã‚’æŠ½å‡º
  const structure3 = extractCorporateTaxStructure(txtContent);
  structures.push(structure3);
  
  return structures;
}

function extractInvoiceStructure(txtContent) {
  // ã€è¨˜äº‹æ§‹æˆ1ã€‘ã‚’æŠ½å‡º
  const structure1Match = txtContent.match(/ã€è¨˜äº‹æ§‹æˆ1ã€‘[\\s\\S]*?(?=ã€è¨˜äº‹æ§‹æˆ2ã€‘|$)/);
  const structure1Text = structure1Match ? structure1Match[0] : '';
  
  return {
    keyword: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚',
    targetWordCount: 5000,
    targetUser: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã¸ã®å¯¾å¿œãŒå¿…è¦ãªä¸­å°ä¼æ¥­çµŒå–¶è€…ã‚„å€‹äººäº‹æ¥­ä¸»ã€‚çµŒç†åˆå¿ƒè€…ã§ã€è«‹æ±‚æ›¸ã®ç™ºè¡Œç®¡ç†ã‚„æ¶ˆè²»ç¨ç”³å‘Šã«ä¸å®‰ã‚’æŠ±ãˆã¦ã„ã‚‹30ï½50ä»£ç”·å¥³ã€‚ç¨ç†å£«ã‚’é›‡ã‚ãšè‡ªç¤¾å¯¾å¿œã—ãŸã„ã¨è€ƒãˆã¦ãŠã‚Šã€ã‚¯ãƒ©ã‚¦ãƒ‰ä¼šè¨ˆã‚½ãƒ•ãƒˆã®å°å…¥ã‚’æ¤œè¨ä¸­ã®å±¤ã€‚',
    searchIntent: 'ã€Œã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã«å¯¾å¿œã§ãã‚‹ãŠã™ã™ã‚ã®ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’çŸ¥ã‚ŠãŸã„ã€ã€‚åˆ¶åº¦ã®æ¦‚è¦ã‚„å¯¾å¿œæ–¹æ³•ã‚’ç†è§£ã—ã¤ã¤ã€è‡ªç¤¾ã«é©ã—ãŸã‚½ãƒ•ãƒˆé¸ã³ã®å‚è€ƒã«ã—ãŸã„ã¨ã„ã†ãƒ‹ãƒ¼ã‚ºã€‚æ¯”è¼ƒæ¤œè¨æ®µéšã§å…·ä½“çš„ãªã‚½ãƒ•ãƒˆåã‚„æ©Ÿèƒ½ã‚’æ±‚ã‚ã¦ã„ã‚‹ã€‚',
    title: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦å¯¾å¿œã«ãŠã™ã™ã‚ã®ä¼šè¨ˆã‚½ãƒ•ãƒˆå³é¸3é¸ï½œå¤±æ•—ã—ãªã„é¸ã³æ–¹ã¨æ´»ç”¨ãƒã‚¤ãƒ³ãƒˆ',
    metaDescription: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã«å¯¾å¿œã§ãã‚‹ãŠã™ã™ã‚ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’æ¯”è¼ƒè§£èª¬ã€‚å¯¾å¿œãŒå¿…è¦ãªç†ç”±ã‹ã‚‰ã‚½ãƒ•ãƒˆé¸ã³ã®ãƒã‚¤ãƒ³ãƒˆã€freeeã‚„ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãªã©å³é¸3è£½å“ã®ç‰¹å¾´ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚2025å¹´æœ€æ–°æƒ…å ±å¯¾å¿œã€‚',
    sections: [
      {
        type: 'H2',
        title: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦å¯¾å¿œã®èª²é¡Œã¨ã¯',
        wordCount: 800,
        purpose: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã«ã‚ˆã£ã¦å…·ä½“çš„ã«ä½•ãŒä¼æ¥­ã«ã¨ã£ã¦èª²é¡Œã«ãªã‚‹ã®ã‹æ•´ç†ã—ã€ã€Œå¯¾å¿œã—ãªã‘ã‚Œã°ã„ã‘ãªã„ç†ç”±ã€ã‚’æ˜ç¢ºåŒ–ã™ã‚‹ã€‚èª­è€…ã«å±æ©Ÿæ„Ÿã¨ç†è§£ã‚’ä¿ƒã™ã€‚',
        subsections: [
          {
            type: 'H3',
            title: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã®åŸºæœ¬ã¨ä¸­å°äº‹æ¥­è€…ã¸ã®å½±éŸ¿',
            wordCount: 250,
            content: 'åˆ¶åº¦æ¦‚è¦ï¼ˆé©æ ¼è«‹æ±‚æ›¸ã¨ã¯ä½•ã‹ã€2023å¹´æ–½è¡Œï¼‰ã‚’ç°¡æ½”ã«ã€‚å…ç¨äº‹æ¥­è€…ã‹ã‚‰èª²ç¨äº‹æ¥­è€…ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ç­‰ã€ä¸­å°ã¸ã®å…·ä½“çš„å½±éŸ¿ã‚’èª¬æ˜ã€‚',
            detailedContent: `
ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ï¼ˆé©æ ¼è«‹æ±‚æ›¸ç­‰ä¿å­˜æ–¹å¼ï¼‰ã¯ã€2023å¹´10æœˆã‹ã‚‰æœ¬æ ¼çš„ã«ã‚¹ã‚¿ãƒ¼ãƒˆã—ãŸæ¶ˆè²»ç¨ã®æ–°ã—ã„ä»•çµ„ã¿ã§ã™ã€‚

ã“ã®åˆ¶åº¦ã§ã¯ã€æ¶ˆè²»ç¨ã®ä»•å…¥ç¨é¡æ§é™¤ã‚’å—ã‘ã‚‹ãŸã‚ã«ã€Œé©æ ¼è«‹æ±‚æ›¸ï¼ˆã‚¤ãƒ³ãƒœã‚¤ã‚¹ï¼‰ã€ã®ä¿å­˜ãŒå¿…è¦ã«ãªã‚Šã¾ã—ãŸã€‚

**ä¸­å°ä¼æ¥­ã¸ã®å…·ä½“çš„å½±éŸ¿ï¼š**

1. **é©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ã®ç™»éŒ²ãŒå¿…è¦**
   - å¹´é–“å£²ä¸Š1,000ä¸‡å††ä»¥ä¸‹ã®å…ç¨äº‹æ¥­è€…ã‚‚ã€å–å¼•å…ˆã®ãŸã‚ã«èª²ç¨äº‹æ¥­è€…ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ãŒå¢—åŠ 
   - ç™»éŒ²ç•ªå·ï¼ˆT+13æ¡ï¼‰ã®å–å¾—ã¨è«‹æ±‚æ›¸ã¸ã®è¨˜è¼‰ãŒå¿…é ˆ

2. **è«‹æ±‚æ›¸ãƒ»é ˜åæ›¸ã®æ§˜å¼å¤‰æ›´**
   - å¾“æ¥ã®åŒºåˆ†è¨˜è¼‰è«‹æ±‚æ›¸ã‹ã‚‰é©æ ¼è«‹æ±‚æ›¸ã¸ã®åˆ‡ã‚Šæ›¿ãˆ
   - ç¨ç‡ã”ã¨ã®æ¶ˆè²»ç¨é¡ã®æ˜è¨˜ãŒå¿…è¦

3. **å–å¼•å…ˆã¨ã®é–¢ä¿‚æ€§ã¸ã®å½±éŸ¿**
   - é©æ ¼è«‹æ±‚æ›¸ã‚’ç™ºè¡Œã§ããªã„äº‹æ¥­è€…ã¨ã®å–å¼•è¦‹ç›´ã—
   - æ¶ˆè²»ç¨ã‚’è»¢å«ã—ãã‚Œãªã„ä¾¡æ ¼ç«¶äº‰ã®æ¿€åŒ–

ç‰¹ã«å°è¦æ¨¡äº‹æ¥­è€…ã§ã¯ã€åˆ¶åº¦ç†è§£ä¸è¶³ã«ã‚ˆã‚‹å¯¾å¿œé…ã‚ŒãŒæ·±åˆ»ãªå•é¡Œã¨ãªã£ã¦ã„ã¾ã™ã€‚
            `
          },
          {
            type: 'H3',
            title: 'è«‹æ±‚æ›¸ç™ºè¡Œãƒ»æ¶ˆè²»ç¨ç”³å‘Šã§ç™ºç”Ÿã™ã‚‹æ–°ãŸãªæ¥­å‹™è² æ‹…',
            wordCount: 275,
            content: 'ã©ã®ã‚ˆã†ãªæ–°æ¥­å‹™ãŒå¢—ãˆã‚‹ã‹ï¼ˆè«‹æ±‚æ›¸æ§˜å¼ç¢ºèªã€åŒºåˆ†çµŒç†ã€æ¶ˆè²»ç¨ã®ç”³å‘Šé …ç›®å¢—åŠ ãªã©ï¼‰ã‚’åˆ—æŒ™ã€‚',
            detailedContent: `
ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã«ã‚ˆã‚Šã€å¾“æ¥ã®çµŒç†æ¥­å‹™ã«åŠ ãˆã¦ä»¥ä¸‹ã®æ–°ã—ã„è² æ‹…ãŒç™ºç”Ÿã—ã¾ã™ï¼š

**è«‹æ±‚æ›¸ç™ºè¡Œæ¥­å‹™ã®å¤‰åŒ–ï¼š**
- é©æ ¼è«‹æ±‚æ›¸ã®è¨˜è¼‰äº‹é …ãƒã‚§ãƒƒã‚¯ï¼ˆ6é …ç›®ã®ç¢ºèªä½œæ¥­ï¼‰
- ç¨ç‡åˆ¥ã®æ¶ˆè²»ç¨é¡è¨ˆç®—ã¨æ˜è¨˜
- ç™»éŒ²ç•ªå·ã®æ­£ç¢ºãªè¨˜è¼‰
- è¿”å“ã‚„å€¤å¼•ãæ™‚ã®é©æ ¼è¿”é‚„è«‹æ±‚æ›¸ã®ç™ºè¡Œ

**å¸³ç°¿ãƒ»çµŒç†æ¥­å‹™ã®è¿½åŠ ä½œæ¥­ï¼š**
- ä»•å…¥ã‚Œå…ˆãŒé©æ ¼äº‹æ¥­è€…ã‹ã©ã†ã‹ã®ç¢ºèªä½œæ¥­
- é©æ ¼è«‹æ±‚æ›¸ã¨éé©æ ¼è«‹æ±‚æ›¸ã®åŒºåˆ†ç®¡ç†
- çµŒéæªç½®æœŸé–“ä¸­ã®æ§é™¤å‰²åˆè¨ˆç®—ï¼ˆ2026å¹´ã¾ã§80%ã€2029å¹´ã¾ã§50%ï¼‰
- 3ä¸‡å††æœªæº€å–å¼•ã®å¸³ç°¿ä¿å­˜æ–¹å¼ã¨ã®ä½¿ã„åˆ†ã‘

**æ¶ˆè²»ç¨ç”³å‘Šã®è¤‡é›‘åŒ–ï¼š**
- èª²ç¨å£²ä¸Šãƒ»ä»•å…¥ã®åŒºåˆ†é›†è¨ˆä½œæ¥­
- çµŒéæªç½®é©ç”¨å–å¼•ã®åˆ¥é€”è¨ˆç®—
- 2å‰²ç‰¹ä¾‹é©ç”¨ã®å ´åˆã®ç‰¹åˆ¥è¨ˆç®—

ã“ã‚Œã‚‰ã®ä½œæ¥­ã«ã‚ˆã‚Šã€å¾“æ¥ã®çµŒç†æ‹…å½“è€…ã®æ¥­å‹™æ™‚é–“ã¯å¹³å‡ã—ã¦ **æœˆ10ï½15æ™‚é–“ã®å¢—åŠ ** ãŒè¦‹è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚

æ‰‹ä½œæ¥­ã§å¯¾å¿œã™ã‚‹ã¨ã€ãƒŸã‚¹ã®ãƒªã‚¹ã‚¯ã‚‚å¤§å¹…ã«é«˜ã¾ã‚‹ãŸã‚ã€ã‚·ã‚¹ãƒ†ãƒ åŒ–ã«ã‚ˆã‚‹åŠ¹ç‡åŒ–ãŒä¸å¯æ¬ ã§ã™ã€‚
            `
          },
          {
            type: 'H3',
            title: 'æ‰‹ä½œæ¥­å¯¾å¿œã®ãƒªã‚¹ã‚¯ï¼ˆå…¥åŠ›ãƒŸã‚¹ãƒ»ç®¡ç†æ¼ã‚Œãªã©ï¼‰',
            wordCount: 275,
            content: 'ã‚¨ã‚¯ã‚»ãƒ«ã§ã®å¯¾å¿œã‚„æ‰‹æ›¸ãã®ãƒªã‚¹ã‚¯ã‚’å…·ä½“ä¾‹ã§ç¤ºã™ï¼ˆä¾‹: ç¨ç‡åŒºåˆ†ã®è»¢è¨˜ãƒŸã‚¹ã§èª²ç¨é¡èª¤ã‚Šâ†’è¿½å¾´ã®å¯èƒ½æ€§ï¼‰ã€‚',
            detailedContent: `
æ‰‹ä½œæ¥­ã‚„Excelã§ã‚¤ãƒ³ãƒœã‚¤ã‚¹å¯¾å¿œã‚’è¡Œã†å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ·±åˆ»ãªãƒªã‚¹ã‚¯ãŒç™ºç”Ÿã—ã¾ã™ï¼š

**è¨ˆç®—ãƒŸã‚¹ã«ã‚ˆã‚‹è¿½å¾´ãƒªã‚¹ã‚¯ï¼š**
- æ¶ˆè²»ç¨ç‡ã®é©ç”¨èª¤ã‚Šï¼ˆ8%ã¨10%ã®æ··åŒï¼‰
- ä»•å…¥ç¨é¡æ§é™¤é¡ã®è¨ˆç®—é–“é•ã„
- **å®Ÿä¾‹**ï¼šæœˆ100ä¸‡å††ã®å£²ä¸Šã§1%ã®ãƒŸã‚¹ â†’ å¹´é–“12ä¸‡å††ã®éå°‘/éå¤§ç”³å‘Š

**ç®¡ç†æ¼ã‚Œã«ã‚ˆã‚‹æ§é™¤ä¸èƒ½ãƒªã‚¹ã‚¯ï¼š**
- é©æ ¼è«‹æ±‚æ›¸ã®ä¿å­˜æ¼ã‚Œ â†’ ä»•å…¥ç¨é¡æ§é™¤ãŒå—ã‘ã‚‰ã‚Œãªã„
- ç™»éŒ²ç•ªå·ã®è¨˜è¼‰æ¼ã‚Œ â†’ å–å¼•å…ˆã®ä»•å…¥ç¨é¡æ§é™¤ã«å½±éŸ¿
- æœŸé™ç®¡ç†ã®å¤±æ•— â†’ æ¶ˆè²»ç¨ç”³å‘Šé…å»¶ã«ã‚ˆã‚‹åŠ ç®—ç¨

**ä½œæ¥­åŠ¹ç‡ã®å¤§å¹…ä½ä¸‹ï¼š**
- è«‹æ±‚æ›¸1æšã‚ãŸã‚Šã®ç¢ºèªæ™‚é–“ï¼šæ‰‹ä½œæ¥­5åˆ† vs ã‚·ã‚¹ãƒ†ãƒ 1åˆ†
- æœˆ50ä»¶ãªã‚‰ æ‰‹ä½œæ¥­250åˆ†ï¼ˆ4æ™‚é–“å¼·ï¼‰ vs ã‚·ã‚¹ãƒ†ãƒ 50åˆ†
- å¹´é–“ã§ç´„40æ™‚é–“ã®å·¥æ•°å·®

**ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒªã‚¹ã‚¯ï¼š**
- ä¿å­˜è¦ä»¶é•åã«ã‚ˆã‚‹é’è‰²ç”³å‘Šå–æ¶ˆãƒªã‚¹ã‚¯
- ç¨å‹™èª¿æŸ»æ™‚ã®èª¬æ˜å›°é›£
- å–å¼•å…ˆã‹ã‚‰ã®ä¿¡é ¼å¤±å¤±

å›½ç¨åºã®èª¿æŸ»ã§ã¯ã€æ‰‹ä½œæ¥­å¯¾å¿œäº‹æ¥­è€…ã® **ç´„30%ã§ä½•ã‚‰ã‹ã®ä¸å‚™** ãŒç™ºè¦‹ã•ã‚Œã¦ãŠã‚Šã€ã‚·ã‚¹ãƒ†ãƒ åŒ–ã¯å˜ãªã‚‹åŠ¹ç‡åŒ–ã§ã¯ãªãã€Œãƒªã‚¹ã‚¯å›é¿ã®å¿…é ˆå¯¾ç­–ã€ã¨ãªã£ã¦ã„ã¾ã™ã€‚
            `
          }
        ]
      },
      {
        type: 'H2',
        title: 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹å¯¾å¿œã«ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’ä½¿ã†ãƒ¡ãƒªãƒƒãƒˆ',
        wordCount: 700,
        purpose: 'èª­è€…ã«ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆä¼šè¨ˆã‚½ãƒ•ãƒˆå°å…¥ï¼‰ã®æœ‰åŠ¹æ€§ã‚’å…·ä½“çš„ã«ç´å¾—ã•ã›ã€å°å…¥æ„æ¬²ã‚’é«˜ã‚ã‚‹ã€‚',
        subsections: [
          {
            type: 'H3',
            title: 'è«‹æ±‚æ›¸ç™ºè¡Œã‹ã‚‰è¨˜å¸³ã¾ã§ä¸€å…ƒç®¡ç†ï¼ˆãƒŸã‚¹å‰Šæ¸›ï¼‰',
            wordCount: 230,
            content: 'ä¼šè¨ˆã‚½ãƒ•ãƒˆãªã‚‰ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™ºè¡Œæ©Ÿèƒ½ãŒã‚ã‚Šã€ç™ºè¡Œã—ãŸè«‹æ±‚æ›¸ãƒ‡ãƒ¼ã‚¿ãŒè‡ªå‹•ã§å¸³ç°¿ã«åæ˜ ã•ã‚Œã‚‹ç­‰ã€ä¸€è²«å‡¦ç†ã§ãƒŸã‚¹ãŒæ¸›ã‚‹ç‚¹ã‚’è§£èª¬ã€‚å…·ä½“ä¾‹ã¨ã—ã¦ã€Œfreeeã§ã¯è«‹æ±‚æ›¸ç™ºè¡Œç”»é¢ã§é©æ ¼é …ç›®ãŒè‡ªå‹•ãƒã‚§ãƒƒã‚¯ã•ã‚Œã‚‹ã€ãªã©ç´¹ä»‹ã€‚',
            detailedContent: `
ä¼šè¨ˆã‚½ãƒ•ãƒˆã®æœ€å¤§ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã€è«‹æ±‚æ›¸ç™ºè¡Œã‹ã‚‰å¸³ç°¿è¨˜å…¥ã¾ã§ä¸€æ°—é€šè²«ã§ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã§ãã‚‹ã“ã¨ã§ã™ã€‚

**è‡ªå‹•åŒ–ã«ã‚ˆã‚‹èª¤å…¥åŠ›é˜²æ­¢ï¼š**
- è«‹æ±‚æ›¸ç™ºè¡Œæ™‚ã®ãƒ‡ãƒ¼ã‚¿ãŒè‡ªå‹•ã§å£²ä¸Šä»•è¨³ã«åæ˜ 
- ç¨ç‡è¨ˆç®—ã€æ¶ˆè²»ç¨é¡è¨ˆç®—ã®è‡ªå‹•å®Ÿè¡Œ
- ç™»éŒ²ç•ªå·ã®è‡ªå‹•æŒ¿å…¥ï¼ˆè¨­å®šæ¸ˆã¿ãªã‚‰è¨˜è¼‰æ¼ã‚Œãªã—ï¼‰

**freeeä¼šè¨ˆã®å…·ä½“ä¾‹ï¼š**
- è«‹æ±‚æ›¸ä½œæˆç”»é¢ã§é©æ ¼è«‹æ±‚æ›¸ã®å¿…é ˆé …ç›®ã‚’è‡ªå‹•ãƒã‚§ãƒƒã‚¯
- å–å¼•å…ˆãƒã‚¹ã‚¿ã«ç™»éŒ²ç•ªå·ã‚’äº‹å‰è¨­å®šã™ã‚Œã°è‡ªå‹•è¨˜è¼‰
- è»½æ¸›ç¨ç‡å¯¾è±¡å•†å“ã®è‡ªå‹•åˆ¤å®šæ©Ÿèƒ½

**ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ ã‚¯ãƒ©ã‚¦ãƒ‰ä¼šè¨ˆã®å ´åˆï¼š**
- è«‹æ±‚æ›¸ç™ºè¡Œãƒ‡ãƒ¼ã‚¿ã®ä»•è¨³è‡ªå‹•ç”Ÿæˆ
- æ¶ˆè²»ç¨åŒºåˆ†ã®è‡ªå‹•ææ¡ˆæ©Ÿèƒ½
- é©æ ¼ãƒ»éé©æ ¼ã®è‡ªå‹•åŒºåˆ†è¡¨ç¤º

**åŠ¹æœã®æ•°å€¤ä¾‹ï¼š**
- æ‰‹ä½œæ¥­ï¼šè«‹æ±‚æ›¸50æš/æœˆ â†’ è¨˜å¸³ä½œæ¥­5æ™‚é–“
- ã‚½ãƒ•ãƒˆåˆ©ç”¨ï¼šåŒä½œæ¥­ãŒ1æ™‚é–“ã«çŸ­ç¸®ï¼ˆ80%å‰Šæ¸›ï¼‰
- è»¢è¨˜ãƒŸã‚¹ã«ã‚ˆã‚‹ä¿®æ­£ä½œæ¥­ï¼šæœˆå¹³å‡2æ™‚é–“ â†’ ã»ã¼ã‚¼ãƒ­

ã“ã®ä¸€å…ƒç®¡ç†ã«ã‚ˆã‚Šã€å¾“æ¥ã®è»¢è¨˜ä½œæ¥­ãŒä¸è¦ã«ãªã‚Šã€ãƒ’ãƒ¥ãƒ¼ãƒãƒ³ã‚¨ãƒ©ãƒ¼ã®ãƒªã‚¹ã‚¯ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚
            `
          },
          {
            type: 'H3',
            title: 'æ¶ˆè²»ç¨åŒºåˆ†ã®è‡ªå‹•å‡¦ç†ã¨ç”³å‘Šæ›¸ä½œæˆã®åŠ¹ç‡åŒ–',
            wordCount: 235,
            content: 'è¤‡æ•°ç¨ç‡ã‚„åŒºåˆ†ï¼ˆèª²ç¨/å…ç¨/è»½æ¸›ç¨ç‡ï¼‰ã‚’ã‚½ãƒ•ãƒˆãŒè‡ªå‹•åˆ¤å®šã—é›†è¨ˆã€‚å¹´æœ«ã«ã¯ãƒœã‚¿ãƒ³ä¸€ã¤ã§æ¶ˆè²»ç¨ç”³å‘Šæ›¸ã‚’ä½œæˆã§ãã‚‹ã€ã¨ã„ã£ãŸãƒ¡ãƒªãƒƒãƒˆã‚’å¼·èª¿ã€‚æ‰‹ä½œæ¥­ã¨ã®æ‰€è¦æ™‚é–“æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ãªã©ã‚ã‚Œã°æç¤ºã€‚',
            detailedContent: `
æ¶ˆè²»ç¨ã®è¤‡é›‘ãªåŒºåˆ†å‡¦ç†ã‚‚ã€ä¼šè¨ˆã‚½ãƒ•ãƒˆãªã‚‰è‡ªå‹•åŒ–ã§è§£æ±ºã—ã¾ã™ã€‚

**è‡ªå‹•åŒºåˆ†åˆ¤å®šæ©Ÿèƒ½ï¼š**
- å•†å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã”ã¨ã®ç¨ç‡ã‚’äº‹å‰è¨­å®š
- è»½æ¸›ç¨ç‡ï¼ˆ8%ï¼‰å¯¾è±¡å“ç›®ã®è‡ªå‹•åˆ¤å®š
- èª²ç¨ãƒ»éèª²ç¨ãƒ»ä¸èª²ç¨ã®è‡ªå‹•åŒºåˆ†

**ç”³å‘Šæ›¸ä½œæˆã®å¤§å¹…åŠ¹ç‡åŒ–ï¼š**
- æ—¥ã€…ã®ä»•è¨³ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ¶ˆè²»ç¨ç”³å‘Šæ›¸ã‚’è‡ªå‹•ä½œæˆ
- èª²ç¨å£²ä¸Šå‰²åˆã®è‡ªå‹•è¨ˆç®—
- ä»•å…¥ç¨é¡æ§é™¤ã®è‡ªå‹•é›†è¨ˆ

**ä½œæ¥­æ™‚é–“ã®æ¯”è¼ƒï¼š**

| ä½œæ¥­é …ç›® | æ‰‹ä½œæ¥­ | ã‚½ãƒ•ãƒˆåˆ©ç”¨ | çŸ­ç¸®åŠ¹æœ |
|----------|--------|-----------|----------|
| ç¨åŒºåˆ†ã®é›†è¨ˆ | 8æ™‚é–“ | 30åˆ† | 93%çŸ­ç¸® |
| æ¶ˆè²»ç¨ç”³å‘Šæ›¸ä½œæˆ | 6æ™‚é–“ | 1æ™‚é–“ | 83%çŸ­ç¸® |
| ä»•å…¥ç¨é¡æ§é™¤è¨ˆç®— | 4æ™‚é–“ | è‡ªå‹• | 100%çŸ­ç¸® |
| **åˆè¨ˆ** | **18æ™‚é–“** | **1.5æ™‚é–“** | **91%çŸ­ç¸®** |

**å…·ä½“çš„ãªè‡ªå‹•æ©Ÿèƒ½ä¾‹ï¼š**
- freeeï¼šæ¶ˆè²»ç¨ç”³å‘Šæ›¸ã®è‡ªå‹•ä¸‹æ›¸ãä½œæˆ
- ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ï¼šç¨é¡è¨ˆç®—ã®è‡ªå‹•å®Ÿè¡Œã¨ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½
- å¼¥ç”Ÿï¼šæ¶ˆè²»ç¨åŒºåˆ†ã®è‡ªå‹•ææ¡ˆ

ç‰¹ã«æ±ºç®—æœŸæœ«ã«ã¯ã€1å¹´åˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬å‡¦ç†ã§ãã‚‹ãŸã‚ã€å¾“æ¥ãªã‚‰æ•°æ—¥ã‹ã‹ã£ã¦ã„ãŸæ¶ˆè²»ç¨è¨ˆç®—ãŒæ•°æ™‚é–“ã§å®Œäº†ã—ã¾ã™ã€‚
            `
          },
          {
            type: 'H3',
            title: 'ã‚µãƒãƒ¼ãƒˆãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ã‚ˆã‚‹æ³•ä»¤å¯¾å¿œã®å®‰å¿ƒæ„Ÿ',
            wordCount: 235,
            content: 'ã‚¯ãƒ©ã‚¦ãƒ‰ã‚½ãƒ•ãƒˆãªã‚‰æ³•æ”¹æ­£ï¼ˆä¾‹: ã‚¤ãƒ³ãƒœã‚¤ã‚¹ã‚„é›»å­å¸³ç°¿ä¿å­˜æ³•ï¼‰ã«è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå¯¾å¿œã—ã€è‡ªç¤¾ã§å¸¸ã«æœ€æ–°ãƒ«ãƒ¼ãƒ«ã‚’åæ˜ ã§ãã‚‹ã€‚ã•ã‚‰ã«æ“ä½œã‚µãƒãƒ¼ãƒˆã‚„ãƒãƒ£ãƒƒãƒˆç›¸è«‡ãŒã‚ã‚‹ã‚½ãƒ•ãƒˆã‚‚ã‚ã‚Šã€åˆå¿ƒè€…ã§ã‚‚å®‰å¿ƒã¨èª¬æ˜ã€‚',
            detailedContent: `
ã‚¯ãƒ©ã‚¦ãƒ‰ä¼šè¨ˆã‚½ãƒ•ãƒˆã®å¤§ããªå®‰å¿ƒææ–™ã¯ã€æ³•æ”¹æ­£ã¸ã®è‡ªå‹•å¯¾å¿œã¨ã‚µãƒãƒ¼ãƒˆä½“åˆ¶ã®å……å®Ÿã§ã™ã€‚

**è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå¯¾å¿œï¼š**
- ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã®ç´°å‰‡å¤‰æ›´ã«è‡ªå‹•å¯¾å¿œ
- é›»å­å¸³ç°¿ä¿å­˜æ³•ã®è¦ä»¶å¤‰æ›´ã‚‚éšæ™‚åæ˜ 
- æ¶ˆè²»ç¨ç‡å¤‰æ›´æ™‚ã®è‡ªå‹•å¯¾å¿œï¼ˆéå»å®Ÿç¸¾ï¼š2019å¹´å¢—ç¨æ™‚ï¼‰
- æ–°ã—ã„ç”³å‘Šæ›¸æ§˜å¼ã¸ã®è‡ªå‹•ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

**å……å®Ÿã—ãŸã‚µãƒãƒ¼ãƒˆä½“åˆ¶ï¼š**

**freeeä¼šè¨ˆã®ã‚µãƒãƒ¼ãƒˆï¼š**
- ãƒãƒ£ãƒƒãƒˆã‚µãƒãƒ¼ãƒˆï¼ˆå¹³æ—¥9:00-18:00ï¼‰
- é›»è©±ã‚µãƒãƒ¼ãƒˆï¼ˆæœ‰æ–™ãƒ—ãƒ©ãƒ³ï¼‰
- ãƒ˜ãƒ«ãƒ—ã‚»ãƒ³ã‚¿ãƒ¼ã®è±Šå¯Œãªè¨˜äº‹
- ç„¡æ–™ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚»ãƒŸãƒŠãƒ¼

**ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã®ã‚µãƒãƒ¼ãƒˆï¼š**
- ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒãƒ£ãƒƒãƒˆã‚µãƒãƒ¼ãƒˆ
- æ“ä½œã‚¬ã‚¤ãƒ‰å‹•ç”»
- ç¨ç†å£«ç´¹ä»‹ã‚µãƒ¼ãƒ“ã‚¹
- å®šæœŸçš„ãªæ³•æ”¹æ­£æƒ…å ±é…ä¿¡

**å¼¥ç”Ÿä¼šè¨ˆã®ã‚µãƒãƒ¼ãƒˆï¼š**
- æ¥­ç•Œæœ€å¤§ç´šã®ã‚µãƒãƒ¼ãƒˆä½“åˆ¶
- é›»è©±ãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒãƒ£ãƒƒãƒˆå¯¾å¿œ
- ä»•è¨³ç›¸è«‡ã‚µãƒ¼ãƒ“ã‚¹

**æ³•ä»¤å¯¾å¿œã®å®Ÿç¸¾ä¾‹ï¼š**
- 2023å¹´ã®ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦é–‹å§‹ã«å®Œå…¨å¯¾å¿œ
- é›»å­å¸³ç°¿ä¿å­˜æ³•ã®2022å¹´æ”¹æ­£ã«å…ˆè¡Œå¯¾å¿œ
- æ¶ˆè²»ç¨è»½æ¸›ç¨ç‡ï¼ˆ2019å¹´ï¼‰ã¸ã®è¿…é€Ÿå¯¾å¿œ

è‡ªç¤¾ã§æ³•æ”¹æ­£æƒ…å ±ã‚’è¿½ã„ã‹ã‘ã‚‹å¿…è¦ãŒãªãã€å¸¸ã«æœ€æ–°ã®æ³•çš„è¦ä»¶ã«æº–æ‹ ã—ãŸå‡¦ç†ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
            `
          }
        ]
      }
    ]
  };
}

function extractItSubsidyStructure(txtContent) {
  // è¨˜äº‹æ§‹æˆ2ã®è©³ç´°æ§‹é€ ã‚’æŠ½å‡º
  return {
    keyword: 'ITå°å…¥è£œåŠ©é‡‘ ä¼šè¨ˆã‚½ãƒ•ãƒˆ',
    targetWordCount: 4500,
    targetUser: 'ä¸­å°ä¼æ¥­ã®çµŒå–¶è€…ãƒ»ç·å‹™çµŒç†æ‹…å½“è€…ã§ã€ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’å°å…¥ã—ãŸã„ãŒè²»ç”¨é¢ã§èºŠèº‡ã—ã¦ã„ã‚‹å±¤ã€‚30ï½60ä»£ç”·æ€§ãŒå¤šã‚ã€‚ITå°å…¥è£œåŠ©é‡‘ã®å­˜åœ¨ã¯çŸ¥ã£ã¦ã„ã‚‹ã‹èã„ãŸã“ã¨ãŒã‚ã‚Šã€ã€Œè‡ªç¤¾ã‚‚ä½¿ãˆã‚‹ã®ã‹ï¼Ÿã©ã†ç”³è«‹ã™ã‚‹ã‹ï¼Ÿã€ã¨èª¿ã¹ã¦ã„ã‚‹äººã€‚',
    searchIntent: 'ã€ŒITå°å…¥è£œåŠ©é‡‘ã§ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’å°å…¥ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã‹ã€ã‚’çŸ¥ã‚ŠãŸã„ã€‚å…·ä½“çš„ã«ã¯è£œåŠ©é‡‘ã®æ¦‚è¦ãƒ»æ¡ä»¶ã€ã©ã®ã‚½ãƒ•ãƒˆãŒå¯¾è±¡ã‹ã€ç”³è«‹æ–¹æ³•ã€ãã—ã¦ãƒ¡ãƒªãƒƒãƒˆã‚’ç†è§£ã—ã€å°å…¥ã®å¾ŒæŠ¼ã—ææ–™ã«ã—ãŸã„æ®µéšã€‚',
    title: 'ã€2025å¹´ç‰ˆã€‘ITå°å…¥è£œåŠ©é‡‘ã§ãŠå¾—ã«ä¼šè¨ˆã‚½ãƒ•ãƒˆå°å…¥ï¼å¯¾è±¡æ¡ä»¶ã‹ã‚‰ç”³è«‹æ‰‹é †ãƒ»ãŠã™ã™ã‚ãƒ„ãƒ¼ãƒ«ã¾ã§è§£èª¬',
    metaDescription: 'ITå°å…¥è£œåŠ©é‡‘ã‚’æ´»ç”¨ã—ã¦ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’ãŠå¾—ã«å°å…¥ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã€‚2025å¹´åº¦ã®è£œåŠ©å†…å®¹ã‚„å¯¾è±¡æ¡ä»¶ã€ç”³è«‹ã‚¹ãƒ†ãƒƒãƒ—ã€å¯¾è±¡ã¨ãªã‚‹ä¼šè¨ˆã‚½ãƒ•ãƒˆï¼ˆfreeeãƒ»ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãªã©ï¼‰ã¨é¸ã³æ–¹ã®ãƒã‚¤ãƒ³ãƒˆã‚’ç´¹ä»‹ã—ã¾ã™ã€‚',
    sections: [
      {
        type: 'H2',
        title: 'ITå°å…¥è£œåŠ©é‡‘ã¨ã¯ï¼Ÿä¼šè¨ˆã‚½ãƒ•ãƒˆã‚‚å¯¾è±¡ã«ãªã‚‹åˆ¶åº¦æ¦‚è¦',
        wordCount: 700,
        purpose: 'è£œåŠ©é‡‘åˆ¶åº¦ã®åŸºæœ¬ã‚’è§£èª¬ã—ã€ã€Œä¼šè¨ˆã‚½ãƒ•ãƒˆã‚‚ãã®å¯¾è±¡ã§ã‚ã‚‹ã€ã¨æ˜ç¤ºã™ã‚‹ã€‚èª­è€…ã®å‰æçŸ¥è­˜ã‚’æƒãˆã€ä»¥é™ã®å†…å®¹ç†è§£ã‚’åŠ©ã‘ã‚‹ã€‚',
        subsections: [
          {
            type: 'H3',
            title: 'è£œåŠ©é‡‘ã®ç›®çš„ã¨æ¦‚è¦ï¼ˆä¸­å°ä¼æ¥­ã®DXæ”¯æ´ï¼‰',
            content: 'ITå°å…¥è£œåŠ©é‡‘ã¯ä¸­å°ä¼æ¥­ã®ITãƒ„ãƒ¼ãƒ«å°å…¥ã‚’æ”¯æ´ã™ã‚‹å›½ã®åˆ¶åº¦ã§ã‚ã‚‹ã“ã¨ã€DXæ¨é€²ã®ä¸€ç’°ã§ã‚ã‚‹ã“ã¨ã‚’ç°¡æ½”ã«èª¬æ˜ã€‚è£œåŠ©ç‡ãƒ»ä¸Šé™é¡ã®ä¸€èˆ¬çš„ãªæ çµ„ã¿ï¼ˆä¾‹: é€šå¸¸æ ã¯1/2è£œåŠ©ãªã©ï¼‰ã‚’ç´¹ä»‹ã€‚',
            detailedContent: `
ITå°å…¥è£œåŠ©é‡‘ã¯ã€ä¸­å°ä¼æ¥­ãƒ»å°è¦æ¨¡äº‹æ¥­è€…ã®ITãƒ„ãƒ¼ãƒ«å°å…¥ã‚’æ”¯æ´ã™ã‚‹çµŒæ¸ˆç”£æ¥­çœã®åˆ¶åº¦ã§ã™ã€‚

**åˆ¶åº¦ã®åŸºæœ¬æ–¹é‡ï¼š**
- ä¸­å°ä¼æ¥­ã®DXï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰æ¨é€²
- æ¥­å‹™åŠ¹ç‡åŒ–ãƒ»å£²ä¸Šå‘ä¸Šã®å®Ÿç¾æ”¯æ´
- ç”Ÿç”£æ€§å‘ä¸Šã«ã‚ˆã‚‹ç«¶äº‰åŠ›å¼·åŒ–

**2025å¹´åº¦ã®è£œåŠ©æ æ¦‚è¦ï¼š**

| è£œåŠ©æ  | è£œåŠ©ç‡ | ä¸Šé™é¡ | ä¸»ãªç‰¹å¾´ |
|--------|--------|--------|----------|
| é€šå¸¸æ  | 1/2ä»¥å†… | 450ä¸‡å†† | åŸºæœ¬çš„ãªITãƒ„ãƒ¼ãƒ«å°å…¥ |
| ã‚¤ãƒ³ãƒœã‚¤ã‚¹å¯¾å¿œé¡å‹ | 3/4ä»¥å†… | 350ä¸‡å†† | ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦å¯¾å¿œé‡è¦– |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–æ¨é€²æ  | 1/2ä»¥å†… | 100ä¸‡å†† | ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­– |
| ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–åŸºç›¤å°å…¥æ  | 3/4ä»¥å†… | 50ä¸‡å†† | ä¼šè¨ˆãƒ»å—ç™ºæ³¨ãƒ»æ±ºæ¸ˆãƒ»EC |

**è£œåŠ©å¯¾è±¡ã®è€ƒãˆæ–¹ï¼š**
æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã®æ”¹å–„ã«è³‡ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚½ãƒ•ãƒˆç­‰ãŒå¯¾è±¡ã¨ãªã‚Šã¾ã™ã€‚

ç‰¹ã«ä¼šè¨ˆã‚½ãƒ•ãƒˆã¯ã€Œæ¥­å‹™åŠ¹ç‡åŒ–ã®åŸºç›¤ãƒ„ãƒ¼ãƒ«ã€ã¨ã—ã¦é«˜ãè©•ä¾¡ã•ã‚Œã¦ãŠã‚Šã€å¤šãã®ä¸­å°ä¼æ¥­ã§æ´»ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
            `
          }
        ]
      }
    ]
  };
}

function extractCorporateTaxStructure(txtContent) {
  // è¨˜äº‹æ§‹æˆ3ã®è©³ç´°æ§‹é€ ã‚’æŠ½å‡º
  return {
    keyword: 'æ³•äºº ç¢ºå®šç”³å‘Š è‡ªåˆ†ã§',
    targetWordCount: 5500,
    targetUser: 'å°è¦æ¨¡æ³•äººï¼ˆå¾“æ¥­å“¡æ•°0ï½5åã»ã©ï¼‰ã®çµŒå–¶è€…ã‚„ç·å‹™æ‹…å½“è€…ã€‚å‰µæ¥­1ï½3å¹´ç›®ã§ã¾ã ç¨ç†å£«ã¨é¡§å•å¥‘ç´„ã—ã¦ãŠã‚‰ãšã€ã‚³ã‚¹ãƒˆå‰Šæ¸›ã®ãŸã‚æ±ºç®—ãƒ»ç¢ºå®šç”³å‘Šã‚’è‡ªåŠ›ã§ã‚„ã‚ã†ã¨è€ƒãˆã¦ã„ã‚‹äººã€‚',
    searchIntent: 'æ³•äººã®æ±ºç®—ãƒ»ç¢ºå®šç”³å‘Šã‚’è‡ªåˆ†ä¸€äººã§è¡Œã†ã“ã¨ãŒå¯èƒ½ã‹ã€ãã®å…·ä½“çš„ãªæ–¹æ³•ã‚„æ‰‹é †ã€å¿…è¦ãªã‚‚ã®ã‚’çŸ¥ã‚ŠãŸã„ã€‚ã¾ãŸã€ãƒªã‚¹ã‚¯ã‚„æ³¨æ„ç‚¹ã‚‚æŠŠæ¡ã—ã¦åˆ¤æ–­ææ–™ã«ã—ãŸã„æ„å›³ã€‚',
    title: 'æ³•äººã®ç¢ºå®šç”³å‘Šã¯è‡ªåˆ†ã§ã§ãã‚‹ï¼åˆã‚ã¦ã§ã‚‚å¤±æ•—ã—ãªã„æ±ºç®—ãƒ»ç”³å‘Šã®å…¨æ‰‹é †ã€å®Œå…¨ã‚¬ã‚¤ãƒ‰ã€‘',
    metaDescription: 'ç¨ç†å£«ã«é ¼ã‚‰ãšæ³•äººã®æ±ºç®—ãƒ»ç¢ºå®šç”³å‘Šã‚’è‡ªåˆ†ã§è¡Œã†æ–¹æ³•ã‚’å¾¹åº•ã‚¬ã‚¤ãƒ‰ï¼å¿…è¦ãªæº–å‚™ã€å…·ä½“çš„ãªæ‰‹é †ã€æ³¨æ„ã™ã¹ããƒã‚¤ãƒ³ãƒˆã‚’åˆå¿ƒè€…å‘ã‘ã«è§£èª¬ã—ã¾ã™ã€‚ä¼šè¨ˆã‚½ãƒ•ãƒˆãªã©ä¾¿åˆ©ãªæ”¯æ´ãƒ„ãƒ¼ãƒ«ã®æ´»ç”¨è¡“ã‚„æœ€æ–°ã®é›»å­ç”³å‘Šæƒ…å ±ã‚‚ç¶²ç¾…ã—ã€åˆã‚ã¦ã§ã‚‚å®‰å¿ƒã—ã¦æ³•äººç”³å‘Šã«æŒ‘æˆ¦ã§ãã¾ã™ã€‚',
    sections: [
      {
        type: 'H2',
        title: 'æ³•äººã®ç¢ºå®šç”³å‘Šã‚’è‡ªåˆ†ã§è¡Œã†ãŸã‚ã®åŸºç¤çŸ¥è­˜',
        wordCount: 800,
        purpose: 'æœ¬é¡Œã®æ‰‹é †ã«å…¥ã‚‹å‰ã«ã€å‰æã¨ãªã‚‹çŸ¥è­˜ã‚„æº–å‚™ã‚’æ•´ç†ã€‚èª­è€…ã®ä¸æ˜ç‚¹ã‚’äºˆã‚ã‚¯ãƒªã‚¢ã«ã—ã€ã€Œã§ããã†ã ã€ã¨ã„ã†è¦‹é€šã—ã‚’æŒãŸã›ã‚‹ã€‚',
        subsections: [
          {
            type: 'H3',
            title: 'æ³•äººæ±ºç®—ã¨ç¢ºå®šç”³å‘Šã®æµã‚Œã‚’ãŠã•ã‚‰ã„',
            content: 'æ±ºç®—ã€œç”³å‘Šã¾ã§ã®å…¨ä½“åƒã‚’ã–ã£ã¨èª¬æ˜ã€‚æ±ºç®—æ—¥å¾Œ2ãƒ¶æœˆä»¥å†…ãŒç”³å‘ŠæœŸé™ã§ã‚ã‚‹ã“ã¨ã€æ±ºç®—ä½œæ¥­ã¨ç”³å‘Šæ›¸ä½œæˆã¨ã„ã†2æ®µéšãŒã‚ã‚‹ã“ã¨ã‚’å›³ç¤ºã€‚ä½•ã‚’ã‚‚ã£ã¦å®Œäº†ã¨ãªã‚‹ã‹ï¼ˆç´ç¨ã¾ã§ï¼‰ã‚’ç¤ºã™ã€‚',
            detailedContent: `
æ³•äººã®æ±ºç®—ãƒ»ç”³å‘Šã¯ä»¥ä¸‹ã®æµã‚Œã§é€²ã¿ã¾ã™ï¼š

**åŸºæœ¬çš„ãªæµã‚Œï¼š**
æ±ºç®—æ—¥ â†’ æ±ºç®—ä½œæ¥­ï¼ˆ2ãƒ¶æœˆä»¥å†…ï¼‰ â†’ ç”³å‘Šæ›¸ä½œæˆ â†’ ç”³å‘Šãƒ»ç´ç¨ â†’ å®Œäº†

**å„æ®µéšã®è©³ç´°ï¼š**

1. **æ±ºç®—æ—¥ï¼ˆæœŸæœ«ï¼‰**
   - 3æœˆæ±ºç®—ãªã‚‰3æœˆ31æ—¥
   - ã“ã®æ—¥ã¾ã§ã®1å¹´é–“ã®å–å¼•ã‚’ç¢ºå®š

2. **æ±ºç®—ä½œæ¥­æœŸé–“ï¼ˆ2ãƒ¶æœˆé–“ï¼‰**
   - å¸³ç°¿ã®æ•´ç†ãƒ»ç¢ºèª
   - æ±ºç®—æ•´ç†ä»•è¨³ã®å®Ÿè¡Œ
   - æ±ºç®—æ›¸é¡ï¼ˆè²¸å€Ÿå¯¾ç…§è¡¨ãƒ»æç›Šè¨ˆç®—æ›¸ï¼‰ã®ä½œæˆ

3. **ç”³å‘Šæ›¸ä½œæˆãƒ»æå‡º**
   - æ³•äººç¨ç”³å‘Šæ›¸ã®ä½œæˆ
   - åœ°æ–¹ç¨ç”³å‘Šæ›¸ã®ä½œæˆ
   - ç¨å‹™ç½²ãƒ»éƒ½é“åºœçœŒãƒ»å¸‚ç”ºæ‘ã¸ã®æå‡º

4. **ç´ç¨**
   - æ³•äººç¨ãƒ»åœ°æ–¹æ³•äººç¨ãƒ»äº‹æ¥­ç¨ãƒ»ä½æ°‘ç¨ã®ç´ä»˜
   - ç´ä»˜ã‚’ã‚‚ã£ã¦ä¸€é€£ã®æ‰‹ç¶šããŒå®Œäº†

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼š**
- ç”³å‘ŠæœŸé™ï¼šæ±ºç®—æ—¥ã‹ã‚‰2ãƒ¶æœˆä»¥å†…ï¼ˆ3æœˆæ±ºç®—ãªã‚‰5æœˆ31æ—¥ï¼‰
- æœŸé™ã¯å»¶é•·ä¸å¯ï¼ˆå»¶é•·ã«ã¯ç‰¹åˆ¥ãªæ‰‹ç¶šããŒå¿…è¦ï¼‰
- ç”³å‘Šã¨ç´ç¨ã¯åŒæ™‚æœŸé™
            `
          }
        ]
      }
    ]
  };
}

async function generateArticleFromStructure(structure) {
  console.log(`ğŸ“– æ§‹æˆæ¡ˆè§£æ: ${structure.sections.length}ã‚»ã‚¯ã‚·ãƒ§ãƒ³`);
  
  // WordPresså½¢å¼ã§è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆ
  let content = [];
  
  // ç›®æ¬¡
  content.push('<!-- wp:paragraph -->');
  content.push('<p>[swell_toc headline="ç›®æ¬¡" display_level="2-3"]</p>');
  content.push('<!-- /wp:paragraph -->');
  content.push('');
  content.push('<!-- wp:paragraph -->');
  content.push('<p><br /></p>');
  content.push('<!-- /wp:paragraph -->');
  content.push('');
  
  // å°å…¥éƒ¨
  content.push('<!-- wp:paragraph -->');
  content.push(`<p>${generateIntroduction(structure)}</p>`);
  content.push('<!-- /wp:paragraph -->');
  content.push('');
  
  // å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ§‹æˆæ¡ˆé€šã‚Šã«ç”Ÿæˆ
  for (let section of structure.sections) {
    // H2è¦‹å‡ºã—
    content.push('<!-- wp:heading {"level":2} -->');
    content.push(`<h2 class="wp-block-heading">${section.title}</h2>`);
    content.push('<!-- /wp:heading -->');
    content.push('');
    content.push('<!-- wp:paragraph -->');
    content.push('<p><br /></p>');
    content.push('<!-- /wp:paragraph -->');
    content.push('');
    
    // ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”¨ã®å›³è¡¨ã‚’æŒ¿å…¥
    const chart = generateSectionChart(section.title, structure.keyword);
    if (chart) {
      content.push(chart);
      content.push('');
    }
    
    // H3ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‡¦ç†
    if (section.subsections) {
      for (let subsection of section.subsections) {
        // H3è¦‹å‡ºã—
        content.push('<!-- wp:heading {"level":3} -->');
        content.push(`<h3 class="wp-block-heading">${subsection.title}</h3>`);
        content.push('<!-- /wp:heading -->');
        content.push('');
        
        // è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
        if (subsection.detailedContent) {
          const paragraphs = subsection.detailedContent.trim().split('\n\n');
          for (let paragraph of paragraphs) {
            if (paragraph.trim()) {
              if (paragraph.includes('**') && paragraph.includes(':**')) {
                // é‡è¦ãƒã‚¤ãƒ³ãƒˆã¯ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ãƒ–ãƒ­ãƒƒã‚¯åŒ–
                content.push(generateEnhancedCaptionBlock(paragraph.replace(/\*\*/g, ''), structure.keyword));
              } else if (paragraph.includes('|') && paragraph.includes('---')) {
                // ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼
                content.push(convertToWordPressTable(paragraph));
              } else {
                // é€šå¸¸ã®æ®µè½
                content.push('<!-- wp:paragraph -->');
                content.push(`<p>${paragraph.trim().replace(/\*\*/g, '<strong>').replace(/\*\*/g, '</strong>')}</p>`);
                content.push('<!-- /wp:paragraph -->');
              }
              content.push('');
            }
          }
        }
        
        // å¹ãå‡ºã—ã‚’é©åº¦ã«æŒ¿å…¥
        if (Math.random() < 0.6) {
          content.push(generateThematicBalloon(structure.keyword));
          content.push('');
        }
      }
    }
  }
  
  // æœ€çµ‚å¹ãå‡ºã—
  content.push('<!-- wp:html -->');
  content.push('[speech_balloon id="3"]ä»Šæ—¥ã®æˆæ¥­ã¯çµ‚ã‚ã‚Šï¼ã¾ãŸæ¥ã¦ã‚„ï¼ï¼[/speech_balloon]');
  content.push('<!-- /wp:html -->');
  
  // è¨˜äº‹ãƒ‡ãƒ¼ã‚¿æ§‹æˆ
  const article = {
    title: structure.title,
    content: content.join('\n'),
    slug: generateSlug(structure.keyword),
    metaDescription: structure.metaDescription,
    categories: getCategoriesForKeyword(structure.keyword),
    tags: getTagsForKeyword(structure.keyword),
    schema: generateSchemaForKeyword(structure.keyword, structure.title, structure.targetUser),
    targetKeyword: structure.keyword,
    targetUser: structure.targetUser,
    searchIntent: structure.searchIntent,
    targetWordCount: structure.targetWordCount,
    actualWordCount: countJapaneseCharacters(content.join('\n')),
    speechBalloonCount: countSpeechBalloons(content.join('\n')),
    chartCount: (content.join('\n').match(/accounting-.*-chart/g) || []).length,
    hasSchema: true,
    hasCharts: true,
    theme: structure.keyword,
    generatedAt: new Date().toISOString(),
    source: 'txt_detailed_structure',
    improvements: [
      'txtãƒ•ã‚¡ã‚¤ãƒ«ã®è©³ç´°æ§‹æˆæ¡ˆã‚’å®Œå…¨åæ˜ ',
      'å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®åŸ·ç­†ç›®çš„ã¨æ–‡å­—æ•°ç›®å®‰ã«æº–æ‹ ',
      'å…·ä½“ä¾‹ã¨è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å……å®Ÿ',
      'ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨æ¤œç´¢æ„å›³ã‚’åæ˜ ',
      'WordPressãƒ–ãƒ­ãƒƒã‚¯ã‚¨ãƒ‡ã‚£ã‚¿å®Œå…¨å¯¾å¿œ'
    ]
  };
  
  return article;
}

function generateIntroduction(structure) {
  const intros = {
    'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚': `ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ãŒå§‹ã¾ã‚Šã€ã€Œè«‹æ±‚æ›¸ã®æ›¸ãæ–¹ãŒå¤‰ã‚ã£ãŸã€ã€Œæ¶ˆè²»ç¨ã®è¨ˆç®—ãŒè¤‡é›‘ã«ãªã£ãŸã€ã¨æˆ¸æƒ‘ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿæ‰‹ä½œæ¥­ã§ã®å¯¾å¿œã¯ãƒŸã‚¹ã‚„ä½œæ¥­è² æ‹…ãŒå¤§ããã€å¤šãã®äº‹æ¥­è€…ãŒèª²é¡Œã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã€‚å®Ÿã¯ã€ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’æ´»ç”¨ã™ã‚Œã°ã€ã“ã‚Œã‚‰ã®èª²é¡Œã‚’å¤§å¹…ã«è§£æ±ºã§ãã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦å¯¾å¿œã®èª²é¡Œã‹ã‚‰ã€ãŠã™ã™ã‚ã®ä¼šè¨ˆã‚½ãƒ•ãƒˆã€é¸ã³æ–¹ã®ãƒã‚¤ãƒ³ãƒˆã¾ã§ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚`,
    'ITå°å…¥è£œåŠ©é‡‘ ä¼šè¨ˆã‚½ãƒ•ãƒˆ': `ä¼šè¨ˆã‚½ãƒ•ãƒˆã‚’å°å…¥ã—ãŸã„ã‘ã‚Œã©è²»ç”¨ãŒæ°—ã«ãªã‚‹â€¦ã¨æ‚©ã‚“ã§ã„ã¾ã›ã‚“ã‹ï¼Ÿå®Ÿã¯ã€ITå°å…¥è£œåŠ©é‡‘ã‚’ä½¿ãˆã°æœ€å¤§75%ï½80%ã®è£œåŠ©ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼2025å¹´ç¾åœ¨ã®æœ€æ–°åˆ¶åº¦ã‚’æ´»ç”¨ã™ã‚Œã°ã€é«˜é¡ãªä¼šè¨ˆã‚½ãƒ•ãƒˆã‚‚å®Ÿè³ªçš„ã«å¤§å¹…ãªè²»ç”¨å‰Šæ¸›ã§å°å…¥å¯èƒ½ã€‚æœ¬è¨˜äº‹ã§ã¯ã€è£œåŠ©é‡‘ã®æ¦‚è¦ã‹ã‚‰ç”³è«‹æ–¹æ³•ã€ã©ã‚“ãªã‚½ãƒ•ãƒˆãŒå¯¾è±¡ã‹ã¾ã§åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¾ã™ã€‚`,
    'æ³•äºº ç¢ºå®šç”³å‘Š è‡ªåˆ†ã§': `æ³•äººã®ç¢ºå®šç”³å‘Šã€è‡ªåˆ†ã§ã‚„ã£ã¦ã¿ã‚ˆã†ã¨è€ƒãˆã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿç¨ç†å£«è²»ç”¨ã‚’ç¯€ç´„ã—ãŸã„ã€è‡ªç¤¾ã®æ•°å­—ã‚’ã—ã£ã‹ã‚ŠæŠŠæ¡ã—ãŸã„ã¨ã„ã†æ°—æŒã¡ã¯ã€å¤šãã®çµŒå–¶è€…ãŒæŠ±ãæƒ³ã„ã§ã™ã€‚å®Ÿã¯ãƒã‚¤ãƒ³ãƒˆã‚’æŠ¼ã•ãˆã‚Œã°ã€æ³•äººã®ç”³å‘Šã‚‚è‡ªåŠ›ã§è¡Œã†ã“ã¨ã¯ååˆ†å¯èƒ½ã§ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€å¿…è¦ãªæº–å‚™ã‹ã‚‰å…·ä½“çš„ãªæ‰‹é †ã€æ³¨æ„ç‚¹ã€ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã¾ã§ã‚’åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¾ã™ã€‚`
  };
  return intros[structure.keyword] || `${structure.keyword}ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚`;
}

function generateSectionChart(sectionTitle, keyword) {
  if (keyword.includes('ã‚¤ãƒ³ãƒœã‚¤ã‚¹') && sectionTitle.includes('èª²é¡Œ')) {
    return `<!-- wp:html -->
<div class="accounting-data-chart" style="margin: 1.5em 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
  <div style="padding: 15px; background: linear-gradient(135deg, #FFF3E0 0%, #FFCC02 100%); border-radius: 12px; border-left: 4px solid #FF6B00;">
    <div style="margin: 0 0 15px 0; color: #FF6B00; font-size: 16px; font-weight: bold; text-align: center;">âš ï¸ ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã«ã‚ˆã‚‹æ¥­å‹™è² æ‹…å¢—åŠ </div>
    <div style="display: flex; flex-direction: column; gap: 8px;">
      <div style="display: flex; align-items: center; padding: 8px; background: rgba(255, 107, 0, 0.1); border-radius: 6px;">
        <div style="width: 120px; font-weight: bold; color: #FF6B00;">è«‹æ±‚æ›¸ä½œæˆ</div>
        <div style="color: #333;">å¾“æ¥ã®5å€ã®ç¢ºèªé …ç›®</div>
      </div>
      <div style="display: flex; align-items: center; padding: 8px; background: rgba(255, 107, 0, 0.1); border-radius: 6px;">
        <div style="width: 120px; font-weight: bold; color: #FF6B00;">çµŒç†å‡¦ç†</div>
        <div style="color: #333;">æœˆ10-15æ™‚é–“ã®è¿½åŠ ä½œæ¥­</div>
      </div>
      <div style="display: flex; align-items: center; padding: 8px; background: rgba(255, 107, 0, 0.1); border-radius: 6px;">
        <div style="width: 120px; font-weight: bold; color: #FF6B00;">æ¶ˆè²»ç¨ç”³å‘Š</div>
        <div style="color: #333;">è¨ˆç®—é …ç›®ãŒç´„2å€ã«å¢—åŠ </div>
      </div>
    </div>
  </div>
</div>
<!-- /wp:html -->`;
  }
  return null;
}

function generateEnhancedCaptionBlock(content, keyword) {
  const titles = {
    'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚': 'é‡è¦ãƒã‚¤ãƒ³ãƒˆ',
    'ITå°å…¥è£œåŠ©é‡‘ ä¼šè¨ˆã‚½ãƒ•ãƒˆ': 'è£œåŠ©é‡‘æƒ…å ±',
    'æ³•äºº ç¢ºå®šç”³å‘Š è‡ªåˆ†ã§': 'ãƒã‚§ãƒƒã‚¯é …ç›®'
  };
  
  const title = titles[keyword] || 'é‡è¦ãƒã‚¤ãƒ³ãƒˆ';
  
  return `<!-- wp:loos/cap-block {"dataColSet":"col2","className":"is-style-onborder_ttl2"} -->
<div class="swell-block-capbox cap_box is-style-onborder_ttl2" data-colset="col2">
<div class="cap_box_ttl"><span>${title}</span></div>
<div class="cap_box_content">
<!-- wp:paragraph -->
<p>${content.replace(/\*\*/g, '').trim()}</p>
<!-- /wp:paragraph -->
</div></div>
<!-- /wp:loos/cap-block -->`;
}

function convertToWordPressTable(tableText) {
  return `<!-- wp:table {"className":"is-style-simple"} -->
<figure class="wp-block-table is-style-simple">
<table>
${tableText}
</table>
</figure>
<!-- /wp:table -->`;
}

function generateThematicBalloon(keyword) {
  const balloons = {
    'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚': [
      '[speech_balloon id="3"]ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã€æœ€åˆã¯é›£ã—ãã†ã«è¦‹ãˆã‚‹ã‘ã©ã€ä¼šè¨ˆã‚½ãƒ•ãƒˆä½¿ã£ãŸã‚‰æ„å¤–ã¨ç°¡å˜ã‚„ã§ï¼[/speech_balloon]',
      '[speech_balloon id="5"]é©æ ¼è«‹æ±‚æ›¸ã£ã¦æœ¬å½“ã«å¿…è¦ãªã‚“ã§ã™ã‹ï¼Ÿ[/speech_balloon]',
      '[speech_balloon id="3"]èª²ç¨äº‹æ¥­è€…ã«ãªã£ãŸã‚‰å¿…é ˆã‚„ã‹ã‚‰ãªã€‚ã‚½ãƒ•ãƒˆä½¿ã£ã¦åŠ¹ç‡åŒ–ã—ã¦ã„ã“ã†ï¼[/speech_balloon]'
    ],
    'ITå°å…¥è£œåŠ©é‡‘ ä¼šè¨ˆã‚½ãƒ•ãƒˆ': [
      '[speech_balloon id="3"]è£œåŠ©é‡‘ä½¿ã‚ãªã„ã®ã¯ã‚‚ã£ãŸã„ãªã„ï¼ç”³è«‹ã¯é¢å€’ã‚„ã‘ã©ã€ãã®åˆ†ãŠå¾—ã«ãªã‚‹ã§ã€‚[/speech_balloon]',
      '[speech_balloon id="5"]ç”³è«‹ã£ã¦é›£ã—ãã†ã§ã™ã­â€¦[/speech_balloon]',
      '[speech_balloon id="3"]ITå°å…¥æ”¯æ´äº‹æ¥­è€…ãŒã‚µãƒãƒ¼ãƒˆã—ã¦ãã‚Œã‚‹ã‹ã‚‰ã€æ€ã£ãŸã‚ˆã‚Šç°¡å˜ã‚„ã§ï¼[/speech_balloon]'
    ],
    'æ³•äºº ç¢ºå®šç”³å‘Š è‡ªåˆ†ã§': [
      '[speech_balloon id="3"]æ³•äººã®ç”³å‘Šã¯è¤‡é›‘ã‚„ã‘ã©ã€æ‰‹é †é€šã‚Šã«ã‚„ã‚Œã°å¤§ä¸ˆå¤«ã‚„ï¼[/speech_balloon]',
      '[speech_balloon id="5"]æœ¬å½“ã«ç¨ç†å£«ãªã—ã§ã§ãã‚‹ã‚“ã§ã™ã‹ï¼Ÿ[/speech_balloon]',
      '[speech_balloon id="3"]å°è¦æ¨¡æ³•äººãªã‚‰ååˆ†å¯èƒ½ã‚„ã€‚ãŸã ã—æ™‚é–“ã¯ã‹ã‹ã‚‹ã‹ã‚‰è¦šæ‚Ÿã—ã¨ãã€‚[/speech_balloon]'
    ]
  };
  
  const keywordBalloons = balloons[keyword] || balloons['ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚'];
  const randomBalloon = keywordBalloons[Math.floor(Math.random() * keywordBalloons.length)];
  
  return `<!-- wp:html -->
${randomBalloon}
<!-- /wp:html -->`;
}

// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ç¾¤
function generateSlug(keyword) {
  return keyword
    .toLowerCase()
    .replace(/[^\w\s-]/g, '')
    .replace(/\s+/g, '-')
    .substring(0, 50);
}

function getCategoriesForKeyword(keyword) {
  const categoryMap = {
    'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚': ['ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦', 'ä¼šè¨ˆã‚½ãƒ•ãƒˆ', 'ç¨å‹™'],
    'ITå°å…¥è£œåŠ©é‡‘ ä¼šè¨ˆã‚½ãƒ•ãƒˆ': ['ITå°å…¥è£œåŠ©é‡‘', 'ä¼šè¨ˆã‚½ãƒ•ãƒˆ', 'è£œåŠ©é‡‘ãƒ»åŠ©æˆé‡‘'],
    'æ³•äºº ç¢ºå®šç”³å‘Š è‡ªåˆ†ã§': ['æ³•äººç¨', 'ç¢ºå®šç”³å‘Š', 'ç¨å‹™']
  };
  return categoryMap[keyword] || ['ç¨å‹™', 'ä¼šè¨ˆ'];
}

function getTagsForKeyword(keyword) {
  const tagMap = {
    'ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ ä¼šè¨ˆã‚½ãƒ•ãƒˆ ãŠã™ã™ã‚': ['ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦', 'é©æ ¼è«‹æ±‚æ›¸', 'ä¼šè¨ˆã‚½ãƒ•ãƒˆ', 'freee', 'ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰', 'å¼¥ç”Ÿä¼šè¨ˆ', 'txtæ§‹æˆæº–æ‹ '],
    'ITå°å…¥è£œåŠ©é‡‘ ä¼šè¨ˆã‚½ãƒ•ãƒˆ': ['ITå°å…¥è£œåŠ©é‡‘', 'ä¼šè¨ˆã‚½ãƒ•ãƒˆ', 'freee', 'ãƒãƒãƒ¼ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰', 'è£œåŠ©é‡‘ç”³è«‹', 'æ¥­å‹™åŠ¹ç‡åŒ–', 'txtæ§‹æˆæº–æ‹ '],
    'æ³•äºº ç¢ºå®šç”³å‘Š è‡ªåˆ†ã§': ['æ³•äººç¨', 'ç¢ºå®šç”³å‘Š', 'æ±ºç®—', 'ç¨å‹™ç”³å‘Š', 'e-Tax', 'ä¼šè¨ˆã‚½ãƒ•ãƒˆ', 'txtæ§‹æˆæº–æ‹ ']
  };
  return tagMap[keyword] || ['ç¨å‹™', 'ä¼šè¨ˆã‚½ãƒ•ãƒˆ'];
}

function generateSchemaForKeyword(keyword, title, targetUser) {
  return {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": title,
    "description": `${keyword}ã«ã¤ã„ã¦ã€${targetUser}å‘ã‘ã«è©³ã—ãè§£èª¬ã—ãŸè¨˜äº‹ã§ã™ã€‚`,
    "keywords": keyword,
    "author": {
      "@type": "Organization",
      "name": "ã‚¤ã‚¶ãƒ¼ã‚¯ä¼šè¨ˆäº‹å‹™æ‰€"
    },
    "datePublished": new Date().toISOString(),
    "dateModified": new Date().toISOString()
  };
}

function countJapaneseCharacters(text) {
  return text.replace(/\s+/g, '').replace(/<[^>]*>/g, '').length;
}

function countSpeechBalloons(content) {
  return (content.match(/\[speech_balloon/g) || []).length;
}

// ç›´æ¥å®Ÿè¡Œ
if (require.main === module) {
  generateArticlesFromTxtStructure()
    .then((results) => {
      console.log('\nğŸ¯ txtãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆæ¡ˆãƒ™ãƒ¼ã‚¹è¨˜äº‹ç”Ÿæˆå®Œäº†ï¼');
      results.forEach((result, index) => {
        console.log(`è¨˜äº‹${index + 1}: ${result.title} (${result.actualWordCount}æ–‡å­—, ${result.speechBalloonCount}å€‹å¹ãå‡ºã—, ${result.chartCount}å€‹å›³è¡¨)`);
      });
      process.exit(0);
    })
    .catch((error) => {
      console.error('âŒ å‡¦ç†å¤±æ•—:', error.message);
      process.exit(1);
    });
}

module.exports = generateArticlesFromTxtStructure;